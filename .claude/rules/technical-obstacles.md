# 技術障礙處理規範

> **核心原則**: 遇到技術障礙時，絕不擅自改變設計決策。任何偏離原設計的方案必須獲得用戶確認。

## 🔴 禁止行為（絕對不可違反）

1. **禁止擅自替換設計方案**
   - ❌ 安裝失敗就改用其他組件
   - ❌ API 不可用就改變架構
   - ❌ 遇到困難就簡化功能

2. **禁止隱藏技術問題**
   - ❌ 不告知用戶就使用 workaround
   - ❌ 在 Implementation Notes 中輕描淡寫偏離設計的決定
   - ❌ 假裝問題不存在繼續開發

## ✅ 正確的處理流程

```
遇到技術障礙
    ↓
Step 1: 深入調查根本原因
    - 閱讀錯誤訊息，理解真正的問題
    - 搜尋相關文檔和解決方案
    - 嘗試至少 3 種不同的解決方法
    ↓
Step 2: 記錄調查過程
    - 記錄嘗試了什麼
    - 記錄每種方法失敗的原因
    - 記錄發現的可能替代方案
    ↓
Step 3: 如果仍無法解決 → 詢問用戶
    - 清楚說明問題是什麼
    - 說明已嘗試的解決方案
    - 提供替代方案選項（含影響分析）
    - 讓用戶決定：繼續調查 / 接受替代方案 / 暫時跳過
    ↓
Step 4: 如果用戶接受替代方案
    - 明確記錄這是偏離原設計的決定
    - 記錄為技術債務
    - 在 Story 的 Implementation Notes 中詳細說明
    - 計劃後續修復時間點
```

## 詢問用戶的模板

當需要偏離原設計時，使用以下格式詢問：

```markdown
## ⚠️ 技術障礙報告

### 問題描述
[清楚描述遇到的問題]

### 已嘗試的解決方案
1. [方案 1] - 結果：[失敗原因]
2. [方案 2] - 結果：[失敗原因]
3. [方案 3] - 結果：[失敗原因]

### 替代方案選項

| 選項 | 方案 | 影響 | 技術債務 |
|------|------|------|----------|
| A | [原設計] | 需要更多調查時間 | 無 |
| B | [替代方案 1] | [UX/功能影響] | [需要後續修復] |
| C | [替代方案 2] | [UX/功能影響] | [需要後續修復] |

### 我的建議
[說明推薦哪個選項及原因]

請問您希望如何處理？
```

## 技術債務記錄格式

如果用戶同意使用替代方案，必須在以下位置記錄：

### 1. Story Implementation Notes
```markdown
### ⚠️ 技術債務

| 項目 | 說明 |
|------|------|
| 原設計 | [原本應該實現的方式] |
| 實際實現 | [因障礙而採用的替代方案] |
| 影響 | [對 UX/功能的影響] |
| 障礙原因 | [為什麼無法按原設計實現] |
| 修復計劃 | [預計何時修復] |
| 用戶確認 | [用戶確認日期] |
```

### 2. 技術債務追蹤文件
在 `docs/04-implementation/technical-debt.md` 中記錄（如不存在則創建）

## 常見情境處理指南

### 情境 1: 套件安裝失敗
```
1. 檢查錯誤訊息
2. 嘗試不同版本
3. 嘗試直接安裝依賴（繞過 CLI）
4. 嘗試手動建立組件
5. 如果都失敗 → 詢問用戶
```

### 情境 2: API 或服務不可用
```
1. 確認是暫時性還是永久性問題
2. 檢查替代 API
3. 檢查是否可以 mock 進行開發
4. 如果影響核心功能 → 詢問用戶
```

### 情境 3: 設計規格不清楚
```
1. 查閱相關文檔（PRD, Tech Spec, UX Design）
2. 參考類似功能的實現
3. 如果仍不清楚 → 詢問用戶（不要自行假設）
```

### 情境 4: 效能或技術限制
```
1. 分析限制的根本原因
2. 評估影響範圍
3. 提供多種解決方案
4. 詢問用戶優先級（功能完整性 vs 效能）
```

## 自我檢查清單

開發過程中，定期問自己：

- [ ] 我實現的功能是否完全符合 Tech Spec？
- [ ] 我是否使用了規格中指定的組件/技術？
- [ ] 我是否因為任何原因偏離了原設計？
- [ ] 如果有偏離，是否已獲得用戶確認？
- [ ] 技術債務是否已正確記錄？

## 違反此規範的後果

如果發現未經確認就偏離設計：
1. 必須立即通知用戶
2. 評估是否需要修復回原設計
3. 補充記錄技術債務
4. 在 Story 完成時標註需要回顧

---

*規範建立日期: 2025-12-18*
*觸發事件: Story 3-1 Slider 組件擅自替換為 number inputs*
