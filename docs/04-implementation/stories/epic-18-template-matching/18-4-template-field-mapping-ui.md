# Story 18.4: Template Field Mapping é…ç½® UI

**Status:** draft

---

## Story

**As a** ç³»çµ±ç®¡ç†å“¡,
**I want** é€šéè¦–è¦ºåŒ–ä»‹é¢é…ç½®ç¬¬äºŒå±¤æ˜ å°„è¦å‰‡,
**So that** æˆ‘å¯ä»¥è¼•é¬†è¨­å®šæ¨™æº–æ¬„ä½åˆ°æ¨¡ç‰ˆæ¬„ä½çš„å°æ‡‰é—œä¿‚ã€‚

---

## èƒŒæ™¯èªªæ˜

### å•é¡Œé™³è¿°

Story 18-1 å»ºç«‹äº† TemplateFieldMapping çš„æ•¸æ“šæ¨¡å‹å’Œ APIï¼Œä½†ç¼ºå°‘å‰ç«¯é…ç½®ä»‹é¢ã€‚ç®¡ç†å“¡éœ€è¦ä¸€å€‹ç›´è§€çš„ UI ä¾†ï¼š

1. æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰æ˜ å°„é…ç½®
2. å‰µå»ºæ–°çš„æ˜ å°„é…ç½®ï¼ˆé¸æ“‡æ¨¡ç‰ˆã€ç¯„åœã€æ¬„ä½å°æ‡‰ï¼‰
3. è¦–è¦ºåŒ–ç·¨è¼¯æ¬„ä½æ˜ å°„é—œä¿‚
4. æ¸¬è©¦æ˜ å°„æ•ˆæœ

### UI è¨­è¨ˆæ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Template Field Mapping é…ç½®                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  [+ æ–°å¢æ˜ å°„é…ç½®]   ç¯©é¸: [å…¨éƒ¨ç¯„åœ â–¼] [å…¨éƒ¨æ¨¡ç‰ˆ â–¼] [å…¨éƒ¨å…¬å¸ â–¼]   [æœç´¢...]             â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é…ç½®åç¨±              â”‚ æ•¸æ“šæ¨¡ç‰ˆ          â”‚ ç¯„åœ     â”‚ å„ªå…ˆç´š â”‚ ç‹€æ…‹  â”‚ æ“ä½œ    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ERP æ¨™æº–æ¬„ä½æ˜ å°„      â”‚ ERP æ¨™æº–åŒ¯å…¥æ ¼å¼   â”‚ GLOBAL   â”‚ 0      â”‚ âœ…    â”‚ âœï¸ ğŸ—‘ï¸  â”‚   â”‚
â”‚  â”‚ DHL ç‰¹æ®Šæ¬„ä½æ˜ å°„      â”‚ ERP æ¨™æº–åŒ¯å…¥æ ¼å¼   â”‚ COMPANY  â”‚ 10     â”‚ âœ…    â”‚ âœï¸ ğŸ—‘ï¸  â”‚   â”‚
â”‚  â”‚ è²»ç”¨å ±è¡¨æ¬„ä½æ˜ å°„      â”‚ è²»ç”¨å ±è¡¨æ ¼å¼       â”‚ GLOBAL   â”‚ 0      â”‚ âœ…    â”‚ âœï¸ ğŸ—‘ï¸  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ˜ å°„ç·¨è¼¯å™¨æ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç·¨è¼¯æ˜ å°„é…ç½®ï¼šDHL ç‰¹æ®Šæ¬„ä½æ˜ å°„                                          [å„²å­˜] [å–æ¶ˆ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  åŸºæœ¬è³‡è¨Š                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ åç¨±: [DHL ç‰¹æ®Šæ¬„ä½æ˜ å°„              ]                                           â”‚   â”‚
â”‚  â”‚ æ•¸æ“šæ¨¡ç‰ˆ: [ERP æ¨™æº–åŒ¯å…¥æ ¼å¼ â–¼]                                                   â”‚   â”‚
â”‚  â”‚ ç¯„åœ: â—‹ GLOBAL  â— COMPANY  â—‹ FORMAT                                              â”‚   â”‚
â”‚  â”‚ å…¬å¸: [DHL Express â–¼]                                                            â”‚   â”‚
â”‚  â”‚ å„ªå…ˆç´š: [10]                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚  æ¬„ä½æ˜ å°„                                                          [+ æ–°å¢æ˜ å°„è¦å‰‡]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                                 â”‚   â”‚
â”‚  â”‚   æ¨™æº–æ¬„ä½ (ä¾†æº)              â”€â”€â–º          æ¨¡ç‰ˆæ¬„ä½ (ç›®æ¨™)                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚   â”‚ sea_freight         â”‚â”€â”€â”€â”€ DIRECT â”€â”€â”‚ shipping_cost       â”‚  [âœï¸] [ğŸ—‘ï¸]      â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                                 â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚   â”‚ terminal_handling   â”‚â”€â”€â”€â”€ DIRECT â”€â”€â”‚ port_fees           â”‚  [âœï¸] [ğŸ—‘ï¸]      â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                                 â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚   â”‚ {sea_freight}       â”‚              â”‚                     â”‚                  â”‚   â”‚
â”‚  â”‚   â”‚ + {terminal_handlingâ”‚â”€â”€ FORMULA â”€â”€â”‚ subtotal            â”‚  [âœï¸] [ğŸ—‘ï¸]      â”‚   â”‚
â”‚  â”‚   â”‚ }                   â”‚              â”‚                     â”‚                  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚  é è¦½æ¸¬è©¦                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¼¸å…¥æ•¸æ“š:                           â”‚ è¼¸å‡ºçµæœ:                                  â”‚   â”‚
â”‚  â”‚ { "sea_freight": 500,              â”‚ { "shipping_cost": 500,                   â”‚   â”‚
â”‚  â”‚   "terminal_handling": 100 }       â”‚   "port_fees": 100,                       â”‚   â”‚
â”‚  â”‚                                    â”‚   "subtotal": 600 }                       â”‚   â”‚
â”‚  â”‚                           [æ¸¬è©¦æ˜ å°„]                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Acceptance Criteria

### AC1: æ˜ å°„é…ç½®åˆ—è¡¨é é¢

**Given** /admin/template-field-mappings é é¢
**When** è¨ªå•é é¢
**Then**:
  - é¡¯ç¤ºæ‰€æœ‰æ˜ å°„é…ç½®åˆ—è¡¨
  - æ”¯æ´æŒ‰ç¯„åœã€æ¨¡ç‰ˆã€å…¬å¸ç¯©é¸
  - æ”¯æ´æœç´¢é…ç½®åç¨±

### AC2: å‰µå»ºæ˜ å°„é…ç½®

**Given** é»æ“Šã€Œæ–°å¢æ˜ å°„é…ç½®ã€
**When** å¡«å¯«è¡¨å–®ä¸¦æäº¤
**Then**:
  - æ­£ç¢ºå‰µå»º TemplateFieldMapping è¨˜éŒ„
  - é¸æ“‡ COMPANY ç¯„åœæ™‚é¡¯ç¤ºå…¬å¸é¸æ“‡å™¨
  - é¸æ“‡ FORMAT ç¯„åœæ™‚é¡¯ç¤ºæ–‡ä»¶æ ¼å¼é¸æ“‡å™¨

### AC3: å¯è¦–åŒ–æ˜ å°„ç·¨è¼¯å™¨

**Given** ç·¨è¼¯æ˜ å°„é…ç½®
**When** æ“ä½œæ˜ å°„è¦å‰‡
**Then**:
  - é¡¯ç¤ºã€Œæºæ¬„ä½ â†’ ç›®æ¨™æ¬„ä½ã€çš„è¦–è¦ºåŒ–é€£ç·š
  - æ”¯æ´æ–°å¢ã€ç·¨è¼¯ã€åˆªé™¤æ˜ å°„è¦å‰‡
  - æ”¯æ´é¸æ“‡è½‰æ›é¡å‹ï¼ˆDIRECT / FORMULA / LOOKUPï¼‰
  - FORMULA é¡å‹æ”¯æ´å…¬å¼ç·¨è¼¯å™¨

### AC4: æ¨™æº–æ¬„ä½é¸æ“‡å™¨

**Given** æ–°å¢/ç·¨è¼¯æ˜ å°„è¦å‰‡
**When** é¸æ“‡æºæ¬„ä½
**Then**:
  - é¡¯ç¤ºæ‰€æœ‰å¯ç”¨çš„æ¨™æº–æ¬„ä½åˆ—è¡¨
  - æ”¯æ´æœç´¢å’Œéæ¿¾
  - é¡¯ç¤ºå·²ä½¿ç”¨çš„æ¬„ä½æç¤º

### AC5: æ¨¡ç‰ˆæ¬„ä½é¸æ“‡å™¨

**Given** æ–°å¢/ç·¨è¼¯æ˜ å°„è¦å‰‡
**When** é¸æ“‡ç›®æ¨™æ¬„ä½
**Then**:
  - å¾é—œè¯çš„ DataTemplate è¼‰å…¥æ¬„ä½åˆ—è¡¨
  - é¡¯ç¤ºæ¬„ä½é¡å‹å’Œå¿…å¡«æ¨™è¨˜
  - é¡¯ç¤ºå·²æ˜ å°„çš„æ¬„ä½æç¤º

### AC6: æ˜ å°„æ¸¬è©¦åŠŸèƒ½

**Given** ç·¨è¼¯é é¢çš„ã€Œé è¦½æ¸¬è©¦ã€å€å¡Š
**When** è¼¸å…¥æ¸¬è©¦æ•¸æ“šä¸¦é»æ“Šæ¸¬è©¦
**Then**:
  - åŸ·è¡Œæ˜ å°„è½‰æ›
  - é¡¯ç¤ºè¼¸å‡ºçµæœ
  - é«˜äº®é¡¯ç¤ºéŒ¯èª¤æ¬„ä½

### AC7: i18n æ”¯æ´

**Given** æ‰€æœ‰ UI æ–‡å­—
**When** åˆ‡æ›èªè¨€
**Then** æ­£ç¢ºé¡¯ç¤ºç¿»è­¯å…§å®¹

---

## Tasks / Subtasks

- [ ] **Task 1: åˆ—è¡¨é é¢** (AC: #1)
  - [ ] 1.1 æ–°å¢ `/admin/template-field-mappings/page.tsx`
  - [ ] 1.2 å¯¦ç¾ `TemplateFieldMappingList` çµ„ä»¶
  - [ ] 1.3 å¯¦ç¾ç¯©é¸å™¨çµ„ä»¶
  - [ ] 1.4 æ•´åˆåˆ†é 

- [ ] **Task 2: å‰µå»º/ç·¨è¼¯é é¢** (AC: #2, #3)
  - [ ] 2.1 æ–°å¢ `/admin/template-field-mappings/new/page.tsx`
  - [ ] 2.2 æ–°å¢ `/admin/template-field-mappings/[id]/page.tsx`
  - [ ] 2.3 å¯¦ç¾ `TemplateFieldMappingForm` çµ„ä»¶

- [ ] **Task 3: æ˜ å°„ç·¨è¼¯å™¨** (AC: #3, #4, #5)
  - [ ] 3.1 æ–°å¢ `MappingRuleEditor` çµ„ä»¶
  - [ ] 3.2 å¯¦ç¾è¦–è¦ºåŒ–é€£ç·šæ•ˆæœ
  - [ ] 3.3 å¯¦ç¾æ‹–æ‹½æ’åº
  - [ ] 3.4 å¯¦ç¾æºæ¬„ä½é¸æ“‡å™¨
  - [ ] 3.5 å¯¦ç¾ç›®æ¨™æ¬„ä½é¸æ“‡å™¨

- [ ] **Task 4: è½‰æ›é…ç½®** (AC: #3)
  - [ ] 4.1 å¯¦ç¾ DIRECT è½‰æ› UI
  - [ ] 4.2 å¯¦ç¾ FORMULA è½‰æ› UIï¼ˆå…¬å¼ç·¨è¼¯å™¨ï¼‰
  - [ ] 4.3 å¯¦ç¾ LOOKUP è½‰æ› UIï¼ˆæŸ¥è¡¨ç·¨è¼¯å™¨ï¼‰

- [ ] **Task 5: æ¸¬è©¦é è¦½** (AC: #6)
  - [ ] 5.1 å¯¦ç¾ `MappingTestPanel` çµ„ä»¶
  - [ ] 5.2 å¯¦ç¾è¼¸å…¥æ•¸æ“šç·¨è¼¯å™¨
  - [ ] 5.3 å¯¦ç¾çµæœé¡¯ç¤º
  - [ ] 5.4 æ•´åˆæ¸¬è©¦ API

- [ ] **Task 6: React Hooks**
  - [ ] 6.1 æ–°å¢ `use-template-field-mappings.ts`
  - [ ] 6.2 å¯¦ç¾ useTemplateFieldMappings (åˆ—è¡¨)
  - [ ] 6.3 å¯¦ç¾ useTemplateFieldMapping (è©³æƒ…)
  - [ ] 6.4 å¯¦ç¾ mutations

- [ ] **Task 7: i18n** (AC: #7)
  - [ ] 7.1 æ–°å¢ç¿»è­¯éµåˆ° `messages/*/admin.json`
  - [ ] 7.2 æ›´æ–°æ‰€æœ‰çµ„ä»¶ä½¿ç”¨ useTranslations

---

## Dev Notes

### ä¾è³´é …

- **Story 18-1**: TemplateFieldMapping API
- **Story 16-7**: DataTemplateï¼ˆç²å–æ¨¡ç‰ˆæ¬„ä½åˆ—è¡¨ï¼‰
- **shadcn/ui**: åŸºç¤ UI çµ„ä»¶

### æ–°å¢æ–‡ä»¶

```
src/
â”œâ”€â”€ app/[locale]/(dashboard)/admin/template-field-mappings/
â”‚   â”œâ”€â”€ page.tsx                          # æ–°å¢ï¼šåˆ—è¡¨é é¢
â”‚   â”œâ”€â”€ new/page.tsx                      # æ–°å¢ï¼šå‰µå»ºé é¢
â”‚   â””â”€â”€ [id]/page.tsx                     # æ–°å¢ï¼šç·¨è¼¯é é¢
â”œâ”€â”€ components/features/template-field-mapping/
â”‚   â”œâ”€â”€ index.ts                          # æ–°å¢ï¼šå°å‡º
â”‚   â”œâ”€â”€ TemplateFieldMappingList.tsx      # æ–°å¢
â”‚   â”œâ”€â”€ TemplateFieldMappingForm.tsx      # æ–°å¢
â”‚   â”œâ”€â”€ MappingRuleEditor.tsx             # æ–°å¢
â”‚   â”œâ”€â”€ MappingRuleItem.tsx               # æ–°å¢
â”‚   â”œâ”€â”€ SourceFieldSelector.tsx           # æ–°å¢
â”‚   â”œâ”€â”€ TargetFieldSelector.tsx           # æ–°å¢
â”‚   â”œâ”€â”€ TransformConfigEditor.tsx         # æ–°å¢
â”‚   â”œâ”€â”€ FormulaEditor.tsx                 # æ–°å¢
â”‚   â”œâ”€â”€ LookupTableEditor.tsx             # æ–°å¢
â”‚   â””â”€â”€ MappingTestPanel.tsx              # æ–°å¢
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ use-template-field-mappings.ts    # æ–°å¢
â””â”€â”€ messages/
    â”œâ”€â”€ en/admin.json                     # æ›´æ–°
    â”œâ”€â”€ zh-TW/admin.json                  # æ›´æ–°
    â””â”€â”€ zh-CN/admin.json                  # æ›´æ–°
```

### æ¨™æº–æ¬„ä½åˆ—è¡¨

æä¾›ä¸€å€‹é å®šç¾©çš„æ¨™æº–æ¬„ä½åˆ—è¡¨ä¾›é¸æ“‡ï¼š

```typescript
// src/constants/standard-fields.ts

export const STANDARD_FIELDS = [
  // åŸºæœ¬è³‡è¨Š
  { name: 'invoice_number', label: 'ç™¼ç¥¨è™Ÿç¢¼', category: 'basic' },
  { name: 'invoice_date', label: 'ç™¼ç¥¨æ—¥æœŸ', category: 'basic' },
  { name: 'due_date', label: 'ä»˜æ¬¾åˆ°æœŸæ—¥', category: 'basic' },
  { name: 'po_number', label: 'æ¡è³¼å–®è™Ÿ', category: 'basic' },

  // ä¾›æ‡‰å•†
  { name: 'vendor_name', label: 'ä¾›æ‡‰å•†åç¨±', category: 'vendor' },
  { name: 'vendor_code', label: 'ä¾›æ‡‰å•†ä»£ç¢¼', category: 'vendor' },
  { name: 'vendor_address', label: 'ä¾›æ‡‰å•†åœ°å€', category: 'vendor' },

  // ç‰©æµ
  { name: 'shipment_no', label: 'å‡ºè²¨å–®è™Ÿ', category: 'logistics' },
  { name: 'tracking_number', label: 'è¿½è¹¤è™Ÿç¢¼', category: 'logistics' },
  { name: 'origin', label: 'èµ·é‹åœ°', category: 'logistics' },
  { name: 'destination', label: 'ç›®çš„åœ°', category: 'logistics' },
  { name: 'ship_date', label: 'ç™¼è²¨æ—¥æœŸ', category: 'logistics' },
  { name: 'delivery_date', label: 'äº¤ä»˜æ—¥æœŸ', category: 'logistics' },

  // è²»ç”¨
  { name: 'sea_freight', label: 'æµ·é‹è²»', category: 'charges' },
  { name: 'air_freight', label: 'ç©ºé‹è²»', category: 'charges' },
  { name: 'terminal_handling', label: 'ç¢¼é ­è™•ç†è²»', category: 'charges' },
  { name: 'documentation_fee', label: 'æ–‡ä»¶è²»', category: 'charges' },
  { name: 'customs_fee', label: 'å ±é—œè²»', category: 'charges' },
  { name: 'insurance', label: 'ä¿éšªè²»', category: 'charges' },

  // é‡‘é¡
  { name: 'subtotal', label: 'å°è¨ˆ', category: 'amount' },
  { name: 'tax_amount', label: 'ç¨…é¡', category: 'amount' },
  { name: 'total_amount', label: 'ç¸½é‡‘é¡', category: 'amount' },
  { name: 'currency', label: 'å¹£åˆ¥', category: 'amount' },
];

export const FIELD_CATEGORIES = {
  basic: 'åŸºæœ¬è³‡è¨Š',
  vendor: 'ä¾›æ‡‰å•†',
  logistics: 'ç‰©æµ',
  charges: 'è²»ç”¨',
  amount: 'é‡‘é¡',
};
```

### å…¬å¼ç·¨è¼¯å™¨è¨­è¨ˆ

```typescript
// FormulaEditor æ”¯æ´çš„èªæ³•
// è®Šæ•¸: {field_name}
// é‹ç®—ç¬¦: + - * / ( )
// å‡½æ•¸: round(), floor(), ceil(), abs()

// ç¯„ä¾‹å…¬å¼:
// "{sea_freight} + {terminal_handling}"
// "round({total_amount} * 0.05, 2)"
// "{subtotal} * (1 + {tax_rate})"
```

---

## Implementation Notes

ï¼ˆé–‹ç™¼å®Œæˆå¾Œå¡«å¯«ï¼‰

---

## Related Files

- `src/app/[locale]/(dashboard)/admin/template-field-mappings/` - æ–°å¢
- `src/components/features/template-field-mapping/` - æ–°å¢
- `src/hooks/use-template-field-mappings.ts` - æ–°å¢
