# User Journey Flows

## Journey 1: Amy 的日常發票處理

**角色：** Amy（數據處理專員）
**頻率：** 每日 150-200 張
**目標：** 高效完成發票審核和確認

```mermaid
flowchart TD
    A[登入系統] --> B[首頁：待處理列表]
    B --> C{查看信心度分佈}

    C -->|高信心度 >90%| D[批量選擇]
    D --> E[一鍵批量確認]
    E --> F[Toast: 已確認 X 張]
    F --> B

    C -->|中信心度 70-90%| G[點擊查看詳情]
    G --> H[快速瀏覽提取結果]
    H --> I{結果正確?}
    I -->|是| J[點擊確認]
    I -->|否| K[進入對照審核]
    J --> B

    C -->|低信心度 <70%| K
    K --> L[PDF 並排對照]
    L --> M[智能高亮定位]
    M --> N{修正欄位}
    N --> O[輸入正確值]
    O --> P[確認並提交]
    P --> Q[Toast: 感謝修正]
    Q --> B

    B --> R{全部完成?}
    R -->|是| S[成就展示: 今日完成 156 張]
    R -->|否| C
```

**關鍵設計點：**
- 高信心度走「批量確認」快速通道
- 中信心度提供「快速瀏覽」選項
- 低信心度必須進入「對照審核」

## Journey 2: Kevin 的例外處理

**角色：** Kevin（Super User）
**頻率：** 每日處理 5-10 個例外
**目標：** 處理系統無法自動處理的特殊發票

```mermaid
flowchart TD
    A[收到例外通知] --> B[進入例外隊列]
    B --> C[查看例外原因]

    C -->|PDF 解析失敗| D[手動查看 PDF]
    D --> E[手動輸入關鍵欄位]
    E --> F[標記為已處理]

    C -->|新 Forwarder| G[查看 Forwarder 詳情]
    G --> H[建立新映射規則]
    H --> I[測試映射準確度]
    I --> J{準確率達標?}
    J -->|是| K[啟用新規則]
    J -->|否| H

    C -->|信心度異常低| L[分析低信心原因]
    L --> M{可優化?}
    M -->|是| N[調整映射規則]
    M -->|否| O[標記為特殊格式]

    K --> P[通知 Amy 可繼續處理]
    F --> P
    N --> P
    O --> P
```

## Journey 3: David 的費用分析

**角色：** David（SCM 經理）
**頻率：** 每週/每月
**目標：** 查看費用趨勢和供應商分析

```mermaid
flowchart TD
    A[登入系統] --> B[進入報表模組]
    B --> C[選擇時間範圍]
    C --> D[選擇分析維度]

    D -->|按 Forwarder| E[供應商費用分佈]
    D -->|按時間| F[費用趨勢圖]
    D -->|按貨運類型| G[類型佔比分析]

    E --> H[查看詳細數據]
    F --> H
    G --> H

    H --> I{需要匯出?}
    I -->|是| J[選擇匯出格式]
    J --> K[下載報表]
    I -->|否| L[繼續分析]
    L --> D
```

## Journey 4: 系統自動化處理（夜間）

**角色：** 系統
**頻率：** 每日凌晨
**目標：** 自動處理高信心度發票

```mermaid
flowchart TD
    A[凌晨 2:00 觸發] --> B[掃描待處理隊列]
    B --> C{有待處理發票?}

    C -->|是| D[依次處理每張發票]
    D --> E[AI 提取數據]
    E --> F[計算信心度]
    F --> G{信心度 >90%?}

    G -->|是| H[自動標記為已確認]
    H --> I[記錄處理日誌]

    G -->|否| J[保留在待處理隊列]
    J --> K[標記需人工審核]

    I --> L{還有更多?}
    K --> L
    L -->|是| D
    L -->|否| M[生成處理報告]

    C -->|否| M
    M --> N[發送通知給 Amy]
    N --> O[等待下次觸發]
```

## Journey Patterns

**通用導航模式：**

| 模式 | 描述 | 應用場景 |
|------|------|---------|
| **首頁即工作台** | 登入後直接顯示待處理列表 | 所有角色 |
| **麵包屑導航** | 清晰的層級路徑 | 詳情頁、報表頁 |
| **快捷返回** | 左上角返回按鈕 | 所有詳情頁 |

**決策點模式：**

| 模式 | 描述 | 應用場景 |
|------|------|---------|
| **信心度分流** | 根據信心度決定處理路徑 | Amy 日常處理 |
| **批量 vs 單項** | 用戶選擇處理方式 | 高信心度發票 |
| **確認 vs 修正** | 二選一的清晰選擇 | 對照審核頁 |

**反饋模式：**

| 模式 | 描述 | 應用場景 |
|------|------|---------|
| **即時 Toast** | 操作後立即反饋 | 確認、修正、批量操作 |
| **進度更新** | 側邊欄即時統計 | 處理過程中 |
| **成就展示** | 完成時的成就卡片 | 全部完成時 |

## Flow Optimization Principles

**效率優化：**

| 原則 | 實施方式 |
|------|---------|
| **最少點擊** | 高信心度批量確認只需 2 次點擊 |
| **預載入** | 提前載入下 2 張發票 |
| **智能焦點** | 自動聚焦到需要修正的欄位 |
| **鍵盤友好** | 支援 Tab/Enter/Escape 導航 |

**認知負擔優化：**

| 原則 | 實施方式 |
|------|---------|
| **信息分層** | 高信心度不顯示詳細對照 |
| **漸進展示** | 只在需要時顯示複雜信息 |
| **清晰狀態** | 三重編碼信心度 |
| **上下文保持** | 返回列表保留篩選狀態 |

**錯誤恢復：**

| 場景 | 恢復機制 |
|------|---------|
| **誤確認** | 5 秒內可撤銷 |
| **修正錯誤** | 顯示修正歷史，可回退 |
| **系統錯誤** | 自動保存草稿，可恢復 |
| **網絡中斷** | 離線隊列，恢復後自動同步 |

---
