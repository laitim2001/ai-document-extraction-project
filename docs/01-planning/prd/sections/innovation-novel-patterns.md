# Innovation & Novel Patterns

## Detected Innovation Areas

| 創新領域 | 描述 | 相較傳統方案的優勢 | MVP 優先級 |
|---------|------|-------------------|-----------|
| **三層智能映射架構** | Universal Mapping + Forwarder-Specific + AI Learning | 規則數量從 9,000 降至 800，維護成本降低 90%+ | 🔴 P0 - 核心 |
| **信心度驅動處理** | 非二元的自動化決策，分層處理策略 | 平衡效率與品質，避免過度自動化風險 | 🔴 P0 - 核心 |
| **持續學習閉環** | 人工修正 → 學習庫 → 3 次確認 → 正式規則 | 系統自動優化，無需持續開發介入 | 🟡 P1 - Post-MVP |
| **n8n 工作流整合** | 可視化工作流設計，業務人員可自行調整 | 降低 IT 依賴，快速響應業務變化 | 🟢 P2 - 增強 |
| **多模態 AI 應用** | OCR + 視覺理解雙軌處理 | 處理複雜版面和低品質掃描文件 | 🟡 P1 - 按需啟用 |

## 創新價值量化

### 維護成本對比

| 指標 | 傳統方案 | 本方案 | 節省 |
|------|---------|--------|------|
| **規則數量** | ~9,000 條 | ~800 條 | 91% |
| **新增 Forwarder 時間** | 2-3 週（建立所有規則） | 2-3 天（僅需特定規則） | 80%+ |
| **規則維護人力** | 2-3 人專職 | 0.5 人兼職 | 75%+ |
| **年度維護成本（估計）** | HKD 800K-1.2M | HKD 150K-250K | 70-80% |

### 競爭壁壘分析

| 壁壘類型 | 描述 | 競爭對手複製難度 |
|---------|------|-----------------|
| **數據資產** | 學習庫持續積累的修正規則 | 高 - 需要相同數據量訓練 |
| **領域知識** | Freight Invoice 專屬映射邏輯 | 中 - 需要領域專家投入 |
| **用戶習慣** | 用戶熟悉度和工作流整合 | 中 - 需要遷移成本 |
| **先發優勢** | 預計 6-12 個月的市場領先 | 時間窗口有限 |

## Market Context & Competitive Landscape

### 現有方案比較

| 方案類型 | 代表產品 | 優勢 | 局限 |
|---------|---------|------|------|
| **傳統 OCR** | ABBYY, Tesseract | 成熟、穩定 | 僅文字提取，無智能分類 |
| **文件 AI 平台** | Azure Form Recognizer, AWS Textract | 雲端服務、API 整合 | 通用模型，需大量自定義 |
| **發票自動化** | Basware, Coupa | 完整 AP 流程 | 昂貴、難以自定義、通常針對西方格式 |
| **RPA 方案** | UiPath, Automation Anywhere | 流程自動化 | 維護成本高、脆弱性強 |

### 本方案差異化

1. **專注垂直領域**：Freight Invoice 專屬優化，非通用文件處理
2. **自適應學習**：持續學習機制減少長期維護成本
3. **靈活整合**：n8n 低代碼整合，適應企業既有系統
4. **成本效益**：內部工具定位，無需支付高額 SaaS 訂閱

## 學習機制技術細節

### 規則升級流程

```
┌─────────────────────────────────────────────────────────────────┐
│ 學習機制流程                                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. 用戶修正數據                                                  │
│       ↓                                                          │
│  2. 系統記錄修正                                                  │
│       • 原始值 vs 修正值                                          │
│       • Forwarder + 欄位 + 位置模式                               │
│       • 用戶標記：「正常修正」或「特例，不學習」                    │
│       ↓                                                          │
│  3. 模式匹配判定                                                  │
│       • 同一 Forwarder + 同一欄位 + 相似位置模式                   │
│       • 相似度閾值 ≥ 85%                                          │
│       ↓                                                          │
│  4. 累計確認次數                                                  │
│       • 不同用戶的修正各計 1 次                                    │
│       • 同一用戶的重複修正僅計 1 次                                │
│       ↓                                                          │
│  5. 升級前影響分析                                                │
│       • 計算：此規則會影響多少現有發票？                           │
│       • 高影響（>100 張）：需 Super User 審核                      │
│       • 低影響（≤100 張）：自動升級                                │
│       ↓                                                          │
│  6. 規則版本控制                                                  │
│       • 版本號：v{date}-{seq}                                     │
│       • 保留前 5 個版本供回滾                                      │
│       • 記錄升級原因和影響範圍                                     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 規則衝突處理

| 衝突類型 | 處理方式 |
|---------|---------|
| **新規則 vs 現有規則** | 新規則優先級較低，需人工審核 |
| **Forwarder 規則 vs Universal 規則** | Forwarder 優先 |
| **學習規則 vs 手動規則** | 手動規則優先 |

### 自動回滾機制

| 觸發條件 | 動作 |
|---------|------|
| 升級後 24 小時內準確率下降 > 5% | 自動回滾 + 通知 Super User |
| 用戶投訴同一規則 ≥ 3 次 | 暫停規則 + 人工審核 |
| 影響範圍超出預期 200% | 自動回滾 + 告警 |

## 多模態 AI 觸發策略

### 觸發條件

| 情境 | 處理方式 | 成本影響 |
|------|---------|---------|
| **純 OCR 成功** | 僅使用 Azure Document Intelligence | 基礎成本 |
| **OCR 信心度 < 70%** | 觸發多模態 AI 輔助 | +50% 成本 |
| **已知困難 Forwarder** | 預設使用多模態 | +50% 成本 |
| **用戶手動請求** | 觸發多模態重新處理 | +50% 成本 |

### 降級策略

```
正常模式：Azure DI + Azure OpenAI (多模態)
    ↓ (API 不可用或超時 > 30s)
降級模式 1：僅 Azure DI + 規則映射
    ↓ (Azure DI 不可用)
降級模式 2：排隊等待 + 通知用戶
    ↓ (等待 > 2 小時)
降級模式 3：標記為「需人工處理」
```

## Validation Approach

### 創新驗證策略

| 創新元素 | 驗證方法 | 成功標準 | 驗證時機 |
|---------|---------|---------|---------|
| **三層映射架構** | 黃金標準數據集測試 + 回歸自動化 | ≥90% 準確率 | MVP 0.5 |
| **信心度機制** | A/B 測試框架 | 找到最佳閾值平衡點 | MVP 0.5 |
| **持續學習機制** | 影響分析 + 回滾測試 | 升級成功率 ≥ 95% | MVP 1.0 後 |
| **n8n 整合** | E2E 測試覆蓋 | 非技術人員可獨立調整 | MVP 1.0 |
| **多模態 AI** | 成本/效益追蹤 | ROI > 1.5x | MVP 0.5 |

### 黃金標準數據集管理

| 項目 | 規格 | 管理方式 |
|------|------|---------|
| **規模** | 500-1000 張已標註發票 | Git LFS 版本控制 |
| **覆蓋** | Top 20 Forwarder | 每個至少 25 張 |
| **邊界案例** | 至少 100 張困難案例 | 系統性分類標籤 |
| **更新頻率** | 每季度 10% | PR 審核流程 |
| **標註品質** | 雙人交叉驗證 | 不一致時第三人裁決 |

## Risk Mitigation

### 創新風險與應對

| 風險項目 | 風險等級 | 應對策略 | Fallback 方案 | 量化閾值 |
|---------|---------|---------|--------------|---------|
| **三層架構複雜度** | 中 | MVP 先實現兩層 | 退回純規則方案 | - |
| **AI 學習品質** | 中 | 影響分析 + 人工審核閘門 | 暫停學習，僅用固定規則 | 準確率下降 > 5% |
| **多模態 AI 成本** | 高 | 成本監控 + 選擇性使用 | 僅高價值案例使用 | 見下表 |
| **n8n 穩定性** | 低 | 監控告警 + 錯誤重試 | 手動觸發替代 | uptime < 99% |
| **Azure 服務依賴** | 中 | 多層降級策略 | 離線排隊處理 | 不可用 > 30 分鐘 |

### 成本監控量化閾值

| 指標 | 預算 | 告警閾值 | 自動降級閾值 |
|------|------|---------|-------------|
| **每張發票 AI 成本** | HKD 0.50 | > HKD 0.75 | > HKD 1.00 |
| **月度 AI API 總成本** | HKD 25,000 | > HKD 30,000 | > HKD 40,000 |
| **多模態觸發率** | 20% | > 30% | > 50% |

## User Experience Considerations

### 學習機制的透明度設計

| UX 元素 | 設計原則 | 實現方式 |
|--------|---------|---------|
| **修正時的提示** | 告知用戶修正會被學習 | 「此修正將幫助系統學習」提示 |
| **特例標記** | 給用戶控制權 | 「標記為特例（不學習）」選項 |
| **影響可見性** | 讓用戶看到貢獻 | 「你的修正已幫助處理 XX 張發票」 |
| **規則升級通知** | 慶祝用戶貢獻 | 「🎉 你的修正已升級為正式規則！」 |

### 信心度視覺設計

| 信心度範圍 | 顏色 | 圖示 | 用戶動作 |
|-----------|------|------|---------|
| **> 90%** | 🟢 綠色 | ✓ | 自動處理，可跳過 |
| **70-90%** | 🟡 黃色 | ⚠ | 快速確認 |
| **< 70%** | 🔴 紅色 | ✗ | 完整審核 |

**信心度詳情顯示：**
- 滑鼠懸停顯示「為什麼信心度低？」
- 列出不確定的具體欄位
- 顯示 AI 的替代建議（如有）

### 個人化偏好

允許用戶調整個人的信心度閾值偏好：
- 「我更注重效率」→ 降低需要審核的閾值
- 「我更注重品質」→ 提高需要審核的閾值

## MVP 架構簡化策略

遵循 **Boring Technology** 原則，MVP 階段採用簡化架構：

| 階段 | 實現範圍 | 說明 |
|------|---------|------|
| **MVP 0.5** | 兩層架構（Universal + Forwarder-Specific） | 驗證核心價值 |
| **MVP 1.0** | 加入信心度機制 + 基本監控 | 完整用戶體驗 |
| **MVP 1.5** | 第三層學習機制 | 驗證學習效果 |
| **Post-MVP** | 多模態 AI 全面啟用 + 進階分析 | 效能優化 |

## 技術債務預防

- MVP 階段保持架構簡潔，避免過早優化
- 建立清晰的技術文檔，降低知識依賴
- 定期 Code Review 確保代碼品質
- 監控 AI API 成本，設置預算告警
- 學習機制上線前完成安全閥測試

---
