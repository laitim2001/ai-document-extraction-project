# AI Document Extraction Project - Claude Code é–‹ç™¼æŒ‡å¼•

> æœ¬æ–‡ä»¶ç‚º Claude Code AI åŠ©æ‰‹çš„é–‹ç™¼æŒ‡å¼•ï¼Œè‡ªå‹•ä½œç‚º system prompt è¼‰å…¥ã€‚

---

## é …ç›®æ¦‚è¦½

### é …ç›®ä½¿å‘½

å»ºç«‹ä¸€å¥— AI é©…å‹•çš„æ–‡ä»¶å…§å®¹æå–èˆ‡è‡ªå‹•åˆ†é¡ç³»çµ±ï¼Œå°ˆé–€è§£æ±º SCM éƒ¨é–€è™•ç† Freight Invoice çš„æ•ˆç‡å•é¡Œã€‚

### æ ¸å¿ƒç›®æ¨™

- **å¹´è™•ç†é‡**: 450,000-500,000 å¼µç™¼ç¥¨ï¼ˆAPAC åœ°å€ï¼‰
- **è‡ªå‹•åŒ–ç‡**: 90-95%
- **æº–ç¢ºç‡**: 90-95%
- **ç¯€çœäººæ™‚**: 35,000-40,000 äººæ™‚/å¹´

### æ ¸å¿ƒæ¶æ§‹ - ä¸‰å±¤æ˜ å°„ç³»çµ±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TIER 1: Universal Mappingï¼ˆé€šç”¨å±¤ï¼‰                              â”‚
â”‚ â€¢ è¦†è“‹ 70-80% å¸¸è¦‹è¡“èªï¼Œæ‰€æœ‰ Forwarder é€šç”¨                      â”‚
â”‚ â€¢ ç¶­è­·æˆæœ¬ï¼šä½ï¼ˆåªéœ€ç¶­è­·ä¸€ä»½ï¼‰                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TIER 2: Forwarder-Specific Overrideï¼ˆç‰¹å®šè¦†è“‹å±¤ï¼‰                â”‚
â”‚ â€¢ åªè¨˜éŒ„è©² Forwarder èˆ‡é€šç”¨è¦å‰‡ã€Œä¸åŒã€çš„æ˜ å°„                    â”‚
â”‚ â€¢ ç¶­è­·æˆæœ¬ï¼šä¸­ï¼ˆæ¯å€‹ Forwarder åªéœ€è¨˜éŒ„å·®ç•°ï¼‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TIER 3: LLM Classificationï¼ˆAI æ™ºèƒ½åˆ†é¡ï¼‰                        â”‚
â”‚ â€¢ ç•¶ä»¥ä¸Šéƒ½ç„¡æ³•åŒ¹é…æ™‚ï¼Œä½¿ç”¨ GPT-4o æ™ºèƒ½åˆ†é¡                       â”‚
â”‚ â€¢ å¯è™•ç†å¾æœªè¦‹éçš„æ–°è¡“èª                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿¡å¿ƒåº¦è·¯ç”±æ©Ÿåˆ¶

| ä¿¡å¿ƒåº¦ç¯„åœ | è™•ç†æ–¹å¼     | èªªæ˜                          |
| ---------- | ------------ | ----------------------------- |
| â‰¥ 90%      | AUTO_APPROVE | è‡ªå‹•é€šéï¼Œç„¡éœ€äººå·¥ä»‹å…¥        |
| 70-89%     | QUICK_REVIEW | å¿«é€Ÿäººå·¥ç¢ºèªï¼ˆä¸€éµç¢ºèª/ä¿®æ­£ï¼‰ |
| < 70%      | FULL_REVIEW  | å®Œæ•´äººå·¥å¯©æ ¸ï¼ˆè©³ç´°æª¢æŸ¥ï¼‰      |

---

## æŠ€è¡“æ£§

### æ ¸å¿ƒæ¡†æ¶

- **å‰ç«¯**: Next.js 15 (App Router) + TypeScript
- **æ¨£å¼**: Tailwind CSS + shadcn/ui
- **è³‡æ–™åº«**: PostgreSQL + Prisma ORM
- **ç‹€æ…‹ç®¡ç†**: Zustand (UI) + React Query (Server State)
- **è¡¨å–®**: React Hook Form + Zod é©—è­‰

### å¤–éƒ¨æœå‹™

- **OCR**: Azure Document Intelligence
- **AI**: Azure OpenAI GPT-5.2
- **èªè­‰**: Azure AD (Entra ID) SSO
- **å·¥ä½œæµ**: n8n
- **æ–‡ä»¶ä¾†æº**: SharePoint / Outlook / Azure Blob Storage

### é–‹ç™¼å·¥å…·

- **å®¹å™¨åŒ–**: Docker Compose (PostgreSQL + pgAdmin)
- **ä»£ç¢¼å“è³ª**: ESLint + Prettier
- **å¥—ä»¶ç®¡ç†**: npm

---

## ç›®éŒ„çµæ§‹

```
ai-document-extraction-project/
â”‚
â”œâ”€â”€ .claude/                    # ğŸ¤– Claude Code é…ç½®
â”‚   â”œâ”€â”€ rules/                  # é–‹ç™¼è¦ç¯„ï¼ˆ8 å€‹è¦å‰‡æ–‡ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ general.md          # é€šç”¨é–‹ç™¼è¦ç¯„
â”‚   â”‚   â”œâ”€â”€ typescript.md       # TypeScript è¦ç¯„
â”‚   â”‚   â”œâ”€â”€ services.md         # æœå‹™å±¤è¦ç¯„
â”‚   â”‚   â”œâ”€â”€ api-design.md       # API è¨­è¨ˆè¦ç¯„
â”‚   â”‚   â”œâ”€â”€ components.md       # çµ„ä»¶é–‹ç™¼è¦ç¯„
â”‚   â”‚   â”œâ”€â”€ database.md         # è³‡æ–™åº«è¦ç¯„
â”‚   â”‚   â”œâ”€â”€ testing.md          # æ¸¬è©¦è¦ç¯„
â”‚   â”‚   â””â”€â”€ technical-obstacles.md  # æŠ€è¡“éšœç¤™è™•ç†
â”‚   â””â”€â”€ settings.local.json     # æœ¬åœ°è¨­å®š
â”‚
â”œâ”€â”€ claudedocs/                 # ğŸ“š AI åŠ©æ‰‹æ–‡æª”ç›®éŒ„ï¼ˆè¦‹ä¸‹æ–¹è©³ç´°èªªæ˜ï¼‰
â”‚   â”œâ”€â”€ 1-planning/             # è¦åŠƒæ–‡æª”ï¼ˆEpic æ¶æ§‹è¨­è¨ˆï¼‰
â”‚   â”œâ”€â”€ 2-sprints/              # Sprint æ–‡æª”
â”‚   â”œâ”€â”€ 3-progress/             # é€²åº¦è¿½è¹¤ï¼ˆæ—¥å ±/é€±å ±ï¼‰
â”‚   â”œâ”€â”€ 4-changes/              # è®Šæ›´è¨˜éŒ„ï¼ˆBug/Featureï¼‰
â”‚   â”œâ”€â”€ 5-status/               # ç‹€æ…‹å ±å‘Š
â”‚   â”œâ”€â”€ 6-ai-assistant/         # AI åŠ©æ‰‹ç›¸é—œï¼ˆæƒ…å¢ƒæç¤ºè©ï¼‰
â”‚   â”œâ”€â”€ 7-archive/              # æ­¸æª”æ–‡æª”
â”‚   â””â”€â”€ CLAUDE.md               # ç›®éŒ„ç´¢å¼•
â”‚
â”œâ”€â”€ docs/                       # ğŸ“– é …ç›®æ­£å¼æ–‡æª”
â”‚   â”œâ”€â”€ 00-discovery/           # ç”¢å“æ¢ç´¢éšæ®µ
â”‚   â”œâ”€â”€ 01-planning/            # è¦åŠƒéšæ®µ (PRD, UX)
â”‚   â”œâ”€â”€ 02-architecture/        # æ¶æ§‹è¨­è¨ˆ
â”‚   â”œâ”€â”€ 03-stories/             # ç”¨æˆ¶æ•…äº‹
â”‚   â””â”€â”€ 04-implementation/      # å¯¦æ–½æ–‡æª”
â”‚
â”œâ”€â”€ python-services/            # ğŸ Python å¾Œç«¯æœå‹™
â”‚   â””â”€â”€ (OCR/AI è™•ç†æœå‹™)       # Azure DI + GPT Vision
â”‚
â”œâ”€â”€ openapi/                    # ğŸ“„ OpenAPI è¦æ ¼
â”‚   â””â”€â”€ (API è¦æ ¼æ–‡æª”)          # Swagger/OpenAPI specs
â”‚
â”œâ”€â”€ prisma/                     # ğŸ—„ï¸ Prisma Schema å’Œé·ç§»
â”œâ”€â”€ public/                     # éœæ…‹è³‡æº
â”œâ”€â”€ scripts/                    # å·¥å…·è…³æœ¬
â”‚
â”œâ”€â”€ src/                        # ğŸ’» Next.js æºä»£ç¢¼
â”‚   â”œâ”€â”€ app/                    # App Router é é¢
â”‚   â”‚   â”œâ”€â”€ (auth)/             # èªè­‰ç›¸é—œé é¢
â”‚   â”‚   â”œâ”€â”€ (dashboard)/        # å„€è¡¨æ¿é é¢
â”‚   â”‚   â””â”€â”€ api/                # API è·¯ç”±ï¼ˆ256+ ç«¯é»ï¼‰
â”‚   â”œâ”€â”€ components/             # React çµ„ä»¶ï¼ˆ242+ çµ„ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ ui/                 # shadcn/ui åŸºç¤çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ features/           # åŠŸèƒ½çµ„ä»¶
â”‚   â”‚   â””â”€â”€ layouts/            # ä½ˆå±€çµ„ä»¶
â”‚   â”œâ”€â”€ contexts/               # React Context æä¾›è€…
â”‚   â”œâ”€â”€ events/                 # äº‹ä»¶è™•ç†ç³»çµ±
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šç¾© Hooks
â”‚   â”œâ”€â”€ jobs/                   # èƒŒæ™¯ä»»å‹™å’Œæ’ç¨‹
â”‚   â”œâ”€â”€ lib/                    # å·¥å…·åº«
â”‚   â”œâ”€â”€ middlewares/            # ä¸­é–“ä»¶
â”‚   â”œâ”€â”€ providers/              # æ‡‰ç”¨ç¨‹å¼æä¾›è€…
â”‚   â”œâ”€â”€ services/               # æ¥­å‹™é‚è¼¯æœå‹™å±¤ï¼ˆ91+ æœå‹™ï¼‰
â”‚   â”œâ”€â”€ stores/                 # Zustand ç‹€æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ types/                  # TypeScript é¡å‹å®šç¾©
â”‚   â””â”€â”€ validations/            # Zod é©—è­‰ Schema
â”‚
â”œâ”€â”€ tests/                      # ğŸ§ª æ¸¬è©¦æ–‡ä»¶
â”‚   â”œâ”€â”€ unit/                   # å–®å…ƒæ¸¬è©¦
â”‚   â”œâ”€â”€ integration/            # æ•´åˆæ¸¬è©¦
â”‚   â””â”€â”€ e2e/                    # ç«¯åˆ°ç«¯æ¸¬è©¦
â”‚
â”œâ”€â”€ .github/                    # GitHub Actions CI/CD
â”œâ”€â”€ .bmad/                      # BMAD å·¥ä½œæµé…ç½®
â””â”€â”€ .vscode/                    # VS Code è¨­å®š
```

---

## ğŸ“š ClaudeDocs - AI åŠ©æ‰‹æ–‡æª”ç›®éŒ„

> **å®Œæ•´ç´¢å¼•**: `claudedocs/CLAUDE.md`

### ç›®éŒ„ç”¨é€”

`claudedocs/` æ˜¯ AI åŠ©æ‰‹ï¼ˆClaudeï¼‰èˆ‡é–‹ç™¼åœ˜éšŠå”ä½œç”¢å‡ºçš„é …ç›®æ–‡æª”ä¸­å¿ƒï¼Œç”¨æ–¼ï¼š

| ç”¨é€”            | ç›®éŒ„              | èªªæ˜                     |
| --------------- | ----------------- | ------------------------ |
| **è¦åŠƒæ–‡æª”**    | `1-planning/`     | Epic æ¶æ§‹è¨­è¨ˆã€åŠŸèƒ½è¦åŠƒ  |
| **Sprint è¿½è¹¤** | `2-sprints/`      | Sprint è¨ˆåŠƒè¨˜éŒ„          |
| **é€²åº¦å ±å‘Š**    | `3-progress/`     | æ—¥å ±/é€±å ±ã€é€²åº¦è¿½è¹¤      |
| **è®Šæ›´ç®¡ç†**    | `4-changes/`      | Bug ä¿®å¾©ã€åŠŸèƒ½è®Šæ›´è¨˜éŒ„   |
| **ç‹€æ…‹å ±å‘Š**    | `5-status/`       | æ¸¬è©¦å ±å‘Šã€ç³»çµ±ç‹€æ…‹       |
| **AI å”ä½œ**     | `6-ai-assistant/` | æƒ…å¢ƒæç¤ºè©ã€å·¥ä½œæµç¨‹æŒ‡å— |
| **æ­¸æª”**        | `7-archive/`      | èˆŠç‰ˆæ–‡æª”ã€ç¯„æœ¬           |

### AI åŠ©æ‰‹æƒ…å¢ƒæç¤ºè© (SITUATION)

é–‹ç™¼éç¨‹ä¸­ï¼ŒAI åŠ©æ‰‹æ‡‰æ ¹æ“šä¸åŒæƒ…å¢ƒä½¿ç”¨å°æ‡‰çš„æç¤ºè©ï¼š

| æƒ…å¢ƒ            | æ–‡ä»¶                     | ä½¿ç”¨æ™‚æ©Ÿ             |
| --------------- | ------------------------ | -------------------- |
| **SITUATION-1** | `PROJECT-ONBOARDING.md`  | æ–°æœƒè©±å•Ÿå‹•ã€é …ç›®å…¥é–€ |
| **SITUATION-2** | `FEATURE-DEV-PREP.md`    | åŠŸèƒ½é–‹ç™¼å‰çš„ä»»å‹™åˆ†æ |
| **SITUATION-3** | `FEATURE-ENHANCEMENT.md` | åŠŸèƒ½å¢å¼·ã€ä»£ç¢¼å„ªåŒ–   |
| **SITUATION-4** | `NEW-FEATURE-DEV.md`     | æ–°åŠŸèƒ½å¯¦ä½œåŸ·è¡Œ       |
| **SITUATION-5** | `SAVE-PROGRESS.md`       | ä¿å­˜é€²åº¦ã€æœƒè©±çµæŸ   |

**è·¯å¾‘**: `claudedocs/6-ai-assistant/prompts/SITUATION-*.md`

### æ–‡æª”å‘½åç´„å®š

```
claudedocs/
â”œâ”€â”€ 1-planning/epics/epic-{N}/     # Epic è¦åŠƒ (N: 0-15)
â”œâ”€â”€ 4-changes/bug-fixes/FIX-{NNN}-*.md       # Bug ä¿®å¾©
â”œâ”€â”€ 4-changes/feature-changes/CHANGE-{NNN}-*.md  # åŠŸèƒ½è®Šæ›´
â”œâ”€â”€ 3-progress/daily/{YYYY}-{MM}/{YYYY}-{MM}-{DD}.md  # æ—¥å ±
â””â”€â”€ 3-progress/weekly/{YYYY}-W{WW}.md        # é€±å ±
```

### ç‹€æ…‹æ¨™è¨˜

| æ¨™è¨˜ | å«ç¾©          |
| ---- | ------------- |
| âœ…   | å·²å®Œæˆ        |
| ğŸš§   | é€²è¡Œä¸­        |
| â¸ï¸   | æš«åœ/å¾…é–‹ç™¼   |
| âŒ   | å·²å–æ¶ˆ        |
| âš ï¸   | æœ‰é¢¨éšª/éœ€æ³¨æ„ |

---

## ä»£ç¢¼è¦ç¯„

### æ–‡ä»¶é ­éƒ¨è¨»é‡‹æ¨™æº–ï¼ˆå¿…é ˆéµå®ˆï¼‰

æ‰€æœ‰æ¥­å‹™é‚è¼¯æ–‡ä»¶å¿…é ˆåŒ…å«æ¨™æº– JSDoc é ­éƒ¨è¨»é‡‹ï¼š

```typescript
/**
 * @fileoverview [æ–‡ä»¶çš„ä¸»è¦ç›®çš„å’ŒåŠŸèƒ½æ¦‚è¿°]
 * @description
 *   [æ›´è©³ç´°çš„æè¿°ï¼ŒåŒ…å«ï¼š]
 *   - ä¸»è¦åŠŸèƒ½èªªæ˜
 *   - è¨­è¨ˆæ±ºç­–èªªæ˜
 *   - é‡è¦æ³¨æ„äº‹é …
 *
 * @module [æ¨¡çµ„è·¯å¾‘ï¼Œå¦‚ src/services/mapping]
 * @author [ä½œè€…æˆ–åœ˜éšŠåç¨±]
 * @since [Epic X - Story X.X (åŠŸèƒ½åç¨±)]
 * @lastModified [æœ€å¾Œä¿®æ”¹æ—¥æœŸ YYYY-MM-DD]
 *
 * @features
 *   - [åŠŸèƒ½é» 1]
 *   - [åŠŸèƒ½é» 2]
 *
 * @dependencies
 *   - [ä¾è³´ 1] - [ç”¨é€”èªªæ˜]
 *   - [ä¾è³´ 2] - [ç”¨é€”èªªæ˜]
 *
 * @related
 *   - [ç›¸é—œæ–‡ä»¶è·¯å¾‘ 1] - [é—œä¿‚èªªæ˜]
 *   - [ç›¸é—œæ–‡ä»¶è·¯å¾‘ 2] - [é—œä¿‚èªªæ˜]
 */
```

### é©ç”¨ç¯„åœ

| æ–‡ä»¶é¡å‹                    | æ˜¯å¦éœ€è¦å®Œæ•´é ­éƒ¨ | èªªæ˜           |
| --------------------------- | ---------------- | -------------- |
| Services (`src/services/`)  | âœ… å¿…é ˆ          | æ ¸å¿ƒæ¥­å‹™é‚è¼¯   |
| API Routes (`src/app/api/`) | âœ… å¿…é ˆ          | API ç«¯é»       |
| Hooks (`src/hooks/`)        | âœ… å¿…é ˆ          | è‡ªå®šç¾© Hooks   |
| Utils (`src/lib/`)          | âœ… å¿…é ˆ          | å·¥å…·å‡½æ•¸       |
| Feature Components          | âœ… å¿…é ˆ          | åŠŸèƒ½æ€§çµ„ä»¶     |
| UI Components (`ui/`)       | âŒ ä¸éœ€è¦        | shadcn/ui çµ„ä»¶ |
| Type Definitions            | âš ï¸ ç°¡åŒ–ç‰ˆ        | é¡å‹æ–‡ä»¶       |

### å‡½æ•¸/æ–¹æ³•è¨»é‡‹æ¨™æº–

````typescript
/**
 * [å‡½æ•¸åŠŸèƒ½ç°¡è¿°]
 *
 * @description [è©³ç´°æè¿°ï¼ŒåŒ…å«æ¥­å‹™é‚è¼¯èªªæ˜]
 * @param {Type} paramName - [åƒæ•¸èªªæ˜]
 * @returns {ReturnType} [è¿”å›å€¼èªªæ˜]
 * @throws {ErrorType} [å¯èƒ½æ‹‹å‡ºçš„éŒ¯èª¤]
 * @example
 * ```typescript
 * const result = functionName(param);
 * ```
 */
````

### å‘½åè¦ç¯„

| é¡å‹      | è¦ç¯„             | ç¯„ä¾‹                       |
| --------- | ---------------- | -------------------------- |
| æ–‡ä»¶å    | kebab-case       | `use-document-upload.ts`   |
| çµ„ä»¶      | PascalCase       | `DocumentUploadForm.tsx`   |
| å‡½æ•¸      | camelCase        | `calculateConfidenceScore` |
| å¸¸æ•¸      | UPPER_SNAKE_CASE | `MAX_FILE_SIZE`            |
| é¡å‹/ä»‹é¢ | PascalCase       | `DocumentMetadata`         |
| Enum å€¼   | UPPER_SNAKE_CASE | `Status.PENDING_REVIEW`    |

### TypeScript è¦ç¯„

```typescript
// âœ… å„ªå…ˆä½¿ç”¨ interface å®šç¾©ç‰©ä»¶é¡å‹
interface DocumentMetadata {
  id: string;
  fileName: string;
  forwarderId: string;
}

// âœ… ä½¿ç”¨ type å®šç¾©è¯åˆé¡å‹
type ConfidenceLevel = 'high' | 'medium' | 'low';

// âœ… ä½¿ç”¨ Zod é€²è¡Œé‹è¡Œæ™‚é©—è­‰
const DocumentSchema = z.object({
  id: z.string().cuid(),
  fileName: z.string().min(1),
  forwarderId: z.string().cuid(),
});

// âŒ é¿å…ä½¿ç”¨ any
function process(data: any) { ... }  // ä¸å¥½

// âœ… ä½¿ç”¨å…·é«”é¡å‹æˆ– unknown
function process(data: DocumentMetadata) { ... }  // å¥½
```

---

## API è¨­è¨ˆè¦ç¯„

### è·¯ç”±çµæ§‹

```
src/app/api/
â”œâ”€â”€ v1/
â”‚   â”œâ”€â”€ documents/
â”‚   â”‚   â”œâ”€â”€ route.ts              # GET (list), POST (create)
â”‚   â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts          # GET, PATCH, DELETE
â”‚   â”‚   â”‚   â””â”€â”€ review/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts      # POST (submit review)
â”‚   â”œâ”€â”€ forwarders/
â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â””â”€â”€ mappings/
â”‚       â””â”€â”€ route.ts
```

### éŸ¿æ‡‰æ ¼å¼

**æˆåŠŸéŸ¿æ‡‰ï¼š**

```typescript
{
  success: true,
  data: T,
  meta?: {
    pagination?: { page, limit, total, totalPages }
  }
}
```

**éŒ¯èª¤éŸ¿æ‡‰ (RFC 7807)ï¼š**

```typescript
{
  type: "https://api.example.com/errors/validation",
  title: "Validation Error",
  status: 400,
  detail: "One or more fields failed validation",
  instance: "/api/v1/documents/123",
  errors?: {
    field: ["error message"]
  }
}
```

---

## è³‡æ–™åº«è¦ç¯„

### Prisma Schema å‘½å

```prisma
// æ¨¡å‹åç¨±: PascalCase å–®æ•¸
model Document {
  // æ¬„ä½åç¨±: camelCase
  id            String   @id @default(cuid())
  fileName      String   @map("file_name")
  createdAt     DateTime @default(now()) @map("created_at")

  // é—œè¯æ¬„ä½
  forwarderId   String   @map("forwarder_id")
  forwarder     Forwarder @relation(fields: [forwarderId], references: [id])

  // è¡¨å: snake_case è¤‡æ•¸
  @@map("documents")
}
```

### é·ç§»å‘½å

```bash
# æ ¼å¼: YYYYMMDDHHMMSS_æè¿°
npx prisma migrate dev --name add_confidence_score_to_mappings
```

---

## çµ„ä»¶é–‹ç™¼è¦ç¯„

### çµ„ä»¶çµæ§‹

```typescript
'use client';  // å¦‚æœéœ€è¦å®¢æˆ¶ç«¯äº’å‹•

import * as React from 'react';
// 1. React/Next.js imports
// 2. ç¬¬ä¸‰æ–¹åº«
// 3. æœ¬åœ°çµ„ä»¶
// 4. Hooks
// 5. Utils
// 6. Types

interface ComponentProps {
  // Props å®šç¾©
}

/**
 * @component ComponentName
 * @description çµ„ä»¶åŠŸèƒ½æè¿°
 */
export function ComponentName({ prop1, prop2 }: ComponentProps) {
  // 1. Hooks
  // 2. State
  // 3. Effects
  // 4. Handlers
  // 5. Render

  return (
    // JSX
  );
}
```

### ç‹€æ…‹ç®¡ç†æ¨¡å¼

```typescript
// UI ç‹€æ…‹ - Zustand
// src/stores/ui-store.ts
export const useUIStore = create<UIState>((set) => ({
  sidebarOpen: true,
  toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),
}))

// ä¼ºæœå™¨ç‹€æ…‹ - React Query
// src/hooks/use-documents.ts
export function useDocuments(filters: DocumentFilters) {
  return useQuery({
    queryKey: ['documents', filters],
    queryFn: () => documentApi.list(filters),
  })
}
```

---

## æ¸¬è©¦è¦ç¯„

### æ¸¬è©¦æ–‡ä»¶å‘½å

```
tests/
â”œâ”€â”€ unit/
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ mapping-service.test.ts
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ documents.test.ts
â””â”€â”€ e2e/
    â””â”€â”€ document-workflow.spec.ts
```

### æ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™

- **å–®å…ƒæ¸¬è©¦**: æ ¸å¿ƒæ¥­å‹™é‚è¼¯ 80%+
- **æ•´åˆæ¸¬è©¦**: API ç«¯é» 70%+
- **E2E æ¸¬è©¦**: é—œéµç”¨æˆ¶æµç¨‹

---

## Git è¦ç¯„

### åˆ†æ”¯å‘½å

```
main                    # ç”Ÿç”¢åˆ†æ”¯
develop                 # é–‹ç™¼åˆ†æ”¯
feature/epic-X-story-Y  # åŠŸèƒ½åˆ†æ”¯
fix/issue-description   # ä¿®å¾©åˆ†æ”¯
hotfix/critical-issue   # ç·Šæ€¥ä¿®å¾©
```

### Commit Message æ ¼å¼

```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

**é¡å‹ï¼š**

- `feat`: æ–°åŠŸèƒ½
- `fix`: Bug ä¿®å¾©
- `docs`: æ–‡æª”æ›´æ–°
- `style`: ä»£ç¢¼æ ¼å¼
- `refactor`: é‡æ§‹
- `test`: æ¸¬è©¦ç›¸é—œ
- `chore`: æ§‹å»º/å·¥å…·

**ç¯„ä¾‹ï¼š**

```
feat(document): add confidence score calculation

- Implement three-tier mapping logic
- Add confidence threshold constants
- Create unit tests for edge cases

Relates to: Epic-3, Story-3.2
```

---

## é–‹ç™¼å·¥ä½œæµ

### æœ¬åœ°é–‹ç™¼å•Ÿå‹•

```bash
# 1. å•Ÿå‹•è³‡æ–™åº«
docker-compose up -d

# 2. å®‰è£ä¾è³´
npm install

# 3. ç”Ÿæˆ Prisma Client
npx prisma generate

# 4. åŸ·è¡Œè³‡æ–™åº«é·ç§»
npx prisma migrate dev

# 5. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev
```

### ä»£ç¢¼æäº¤å‰æª¢æŸ¥

```bash
# é¡å‹æª¢æŸ¥
npm run type-check

# Lint æª¢æŸ¥
npm run lint

# æ ¼å¼åŒ–
npm run format

# æ¸¬è©¦
npm run test
```

---

## AI é–‹ç™¼è¼”åŠ©æŒ‡å¼•

### å„ªå…ˆåƒè€ƒæ–‡æª”

1. **Tech Specs**: `docs/03-stories/tech-specs/` - å„ Story çš„æŠ€è¡“è¦æ ¼
2. **Implementation Context**: `docs/04-implementation/implementation-context.md`
3. **PRD**: `docs/01-planning/prd/prd.md`

### ä»£ç¢¼ç”Ÿæˆè¦å‰‡

1. **å¿…é ˆæ·»åŠ æ¨™æº–è¨»é‡‹** - æŒ‰ä¸Šè¿°è¦ç¯„æ·»åŠ æ–‡ä»¶é ­éƒ¨å’Œå‡½æ•¸è¨»é‡‹
2. **éµå¾ªç¾æœ‰æ¨¡å¼** - åƒè€ƒ `src/` ä¸‹ç¾æœ‰ä»£ç¢¼é¢¨æ ¼
3. **é¡å‹å®‰å…¨å„ªå…ˆ** - ä½¿ç”¨åš´æ ¼çš„ TypeScript é¡å‹
4. **Zod é©—è­‰** - API è¼¸å…¥å¿…é ˆä½¿ç”¨ Zod schema é©—è­‰
5. **éŒ¯èª¤è™•ç†** - ä½¿ç”¨ RFC 7807 æ ¼å¼è¿”å›éŒ¯èª¤

### ç¦æ­¢äº‹é …

- âŒ ä¸è¦ä½¿ç”¨ `any` é¡å‹
- âŒ ä¸è¦è·³ééŒ¯èª¤è™•ç†
- âŒ ä¸è¦ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡è¨Š
- âŒ ä¸è¦åœ¨å®¢æˆ¶ç«¯çµ„ä»¶ä¸­ç›´æ¥è¨ªå•è³‡æ–™åº«
- âŒ ä¸è¦å¿½ç•¥ TypeScript éŒ¯èª¤
- âŒ **ä¸è¦æ“…è‡ªåé›¢è¨­è¨ˆè¦æ ¼**ï¼ˆè¦‹ä¸‹æ–¹æŠ€è¡“éšœç¤™è™•ç†è¦ç¯„ï¼‰

---

## ğŸš¨ æŠ€è¡“éšœç¤™è™•ç†è¦ç¯„ï¼ˆå¿…é ˆéµå®ˆï¼‰

> **æ ¸å¿ƒåŸå‰‡**: é‡åˆ°æŠ€è¡“éšœç¤™æ™‚ï¼Œ**çµ•ä¸æ“…è‡ªæ”¹è®Šè¨­è¨ˆæ±ºç­–**ã€‚ä»»ä½•åé›¢åŸè¨­è¨ˆçš„æ–¹æ¡ˆå¿…é ˆç²å¾—ç”¨æˆ¶ç¢ºèªã€‚

### ç¦æ­¢è¡Œç‚º

| ç¦æ­¢            | èªªæ˜                            |
| --------------- | ------------------------------- |
| âŒ æ“…è‡ªæ›¿æ›çµ„ä»¶ | å®‰è£å¤±æ•—ä¸èƒ½ç›´æ¥æ›å…¶ä»–çµ„ä»¶      |
| âŒ ç°¡åŒ–åŠŸèƒ½     | é‡åˆ°å›°é›£ä¸èƒ½æ¸›å°‘åŠŸèƒ½            |
| âŒ éš±è—å•é¡Œ     | ä¸èƒ½ä¸å‘ŠçŸ¥ç”¨æˆ¶å°±ä½¿ç”¨ workaround |

### æ­£ç¢ºè™•ç†æµç¨‹

```
é‡åˆ°æŠ€è¡“éšœç¤™
    â†“
1. æ·±å…¥èª¿æŸ¥æ ¹æœ¬åŸå› ï¼ˆå˜—è©¦è‡³å°‘ 3 ç¨®æ–¹æ³•ï¼‰
    â†“
2. å¦‚æœç„¡æ³•è§£æ±º â†’ å¿…é ˆè©¢å•ç”¨æˆ¶
   - èªªæ˜å•é¡Œæ˜¯ä»€éº¼
   - èªªæ˜å·²å˜—è©¦çš„æ–¹æ¡ˆ
   - æä¾›æ›¿ä»£æ–¹æ¡ˆé¸é …ï¼ˆå«å½±éŸ¿åˆ†æï¼‰
    â†“
3. å¦‚æœç”¨æˆ¶æ¥å—æ›¿ä»£æ–¹æ¡ˆ
   - è¨˜éŒ„ç‚ºæŠ€è¡“å‚µå‹™
   - åœ¨ Implementation Notes è©³ç´°èªªæ˜
```

### è©¢å•æ¨¡æ¿

```markdown
## âš ï¸ æŠ€è¡“éšœç¤™å ±å‘Š

### å•é¡Œï¼š[å•é¡Œæè¿°]

### å·²å˜—è©¦ï¼š

1. [æ–¹æ¡ˆ 1] â†’ [å¤±æ•—åŸå› ]
2. [æ–¹æ¡ˆ 2] â†’ [å¤±æ•—åŸå› ]

### æ›¿ä»£æ–¹æ¡ˆï¼š

| é¸é … | æ–¹æ¡ˆ       | å½±éŸ¿         |
| ---- | ---------- | ------------ |
| A    | ç¹¼çºŒèª¿æŸ¥   | éœ€è¦æ›´å¤šæ™‚é–“ |
| B    | [æ›¿ä»£æ–¹æ¡ˆ] | [å½±éŸ¿èªªæ˜]   |

è«‹å•æ‚¨å¸Œæœ›å¦‚ä½•è™•ç†ï¼Ÿ
```

> ğŸ“‹ å®Œæ•´è¦ç¯„è«‹åƒè€ƒ: `.claude/rules/technical-obstacles.md`

---

## ğŸ”„ é–‹ç™¼å¾Œæ–‡æª”æ›´æ–°æª¢æŸ¥ï¼ˆå¿…é ˆåŸ·è¡Œï¼‰

> **é‡è¦**: æ¯æ¬¡å®Œæˆé–‹ç™¼ä»»å‹™å¾Œï¼ŒAI åŠ©æ‰‹å¿…é ˆåŸ·è¡Œä»¥ä¸‹æª¢æŸ¥æµç¨‹ï¼Œç¢ºä¿é …ç›®æ–‡æª”ä¿æŒæœ€æ–°ç‹€æ…‹ã€‚

### æ–‡æª”æ›´æ–°æ±ºç­–æµç¨‹

```
é–‹ç™¼ä»»å‹™å®Œæˆå¾Œï¼Œä¾åºæª¢æŸ¥ï¼š

1. æ˜¯å¦æ¶‰åŠæŠ€è¡“æ£§/æ¶æ§‹è®Šæ›´ï¼Ÿ
   â””â”€ æ˜¯ â†’ æ›´æ–° CLAUDE.mdï¼ˆæŠ€è¡“æ£§ã€ç›®éŒ„çµæ§‹ç­‰ç« ç¯€ï¼‰

2. æ˜¯å¦æ–°å¢/ä¿®æ”¹æ¨¡çµ„çš„å…¬é–‹ APIï¼Ÿ
   â””â”€ æ˜¯ â†’ æ›´æ–°å°æ‡‰æ¨¡çµ„çš„ index.tsï¼ˆå°å‡ºã€æ–‡æª”è¨»é‡‹ï¼‰

3. æ˜¯å¦ç™¼ç¾æ–°çš„é–‹ç™¼è¦ç¯„/æœ€ä½³å¯¦è¸/è¸©å‘ç¶“é©—ï¼Ÿ
   â””â”€ æ˜¯ â†’ æ›´æ–°å°æ‡‰çš„ .claude/rules/*.md

4. æ˜¯å¦å®Œæˆ Epic/Storyï¼Ÿ
   â””â”€ æ˜¯ â†’ æ›´æ–° CLAUDE.md é …ç›®é€²åº¦è¿½è¹¤è¡¨
```

### å„æ–‡æª”æ›´æ–°æ™‚æ©Ÿ

| æ–‡æª”é¡å‹                | æ›´æ–°è§¸ç™¼æ¢ä»¶                              | æ›´æ–°é »ç‡ |
| ----------------------- | ----------------------------------------- | -------- |
| **CLAUDE.md**           | æŠ€è¡“æ£§è®Šæ›´ã€æ¶æ§‹èª¿æ•´ã€ç›®éŒ„é‡çµ„ã€Epic å®Œæˆ | ä½       |
| **index.ts**            | æ–°å¢æœå‹™ã€å°å‡ºè®Šæ›´ã€å¸¸æ•¸èª¿æ•´              | ä¸­       |
| **.claude/rules/\*.md** | æ–°é–‹ç™¼æ¨¡å¼ã€è¸©å‘ç¶“é©—ã€åœ˜éšŠç´„å®šè®Šæ›´        | ä¸­ä½     |

### é–‹ç™¼å®Œæˆæª¢æŸ¥æ¸…å–®

å®Œæˆæ¯å€‹ Story æˆ–é‡è¦åŠŸèƒ½å¾Œï¼ŒAI åŠ©æ‰‹æ‡‰è‡ªå‹•åŸ·è¡Œä»¥ä¸‹æª¢æŸ¥ï¼š

```markdown
## ğŸ“‹ é–‹ç™¼å®Œæˆæª¢æŸ¥

### ä»£ç¢¼å“è³ª

- [ ] é€šé TypeScript é¡å‹æª¢æŸ¥ (`npm run type-check`)
- [ ] é€šé ESLint æª¢æŸ¥ (`npm run lint`)
- [ ] æ–°å¢ä»£ç¢¼åŒ…å«æ¨™æº– JSDoc è¨»é‡‹

### æ–‡æª”åŒæ­¥

- [ ] å¦‚æ¶‰åŠæ–°æ¨¡çµ„ â†’ å·²æ›´æ–°/å»ºç«‹ index.ts
- [ ] å¦‚æ¶‰åŠæ¶æ§‹è®Šæ›´ â†’ å·²æ›´æ–° CLAUDE.md
- [ ] å¦‚ç™¼ç¾æ–°è¦ç¯„/è¸©å‘ â†’ å·²æ›´æ–° .claude/rules/
- [ ] å¦‚å®Œæˆ Story â†’ å·²æ›´æ–°é …ç›®é€²åº¦

### æ¸¬è©¦é©—è­‰

- [ ] ç›¸é—œæ¸¬è©¦é€šé
- [ ] æ–°åŠŸèƒ½å·²æœ‰å°æ‡‰æ¸¬è©¦ï¼ˆå¦‚é©ç”¨ï¼‰
```

### è‡ªå‹•æé†’è¦å‰‡

AI åŠ©æ‰‹åœ¨ä»¥ä¸‹æƒ…æ³æ‡‰**ä¸»å‹•æé†’**ç”¨æˆ¶è€ƒæ…®æ›´æ–°æ–‡æª”ï¼š

1. **å»ºç«‹æ–°çš„ service æ–‡ä»¶** â†’ æé†’æ›´æ–° `src/services/index.ts`
2. **æ–°å¢å¤–éƒ¨ä¾è³´** â†’ æé†’æª¢æŸ¥æ˜¯å¦éœ€æ›´æ–° CLAUDE.md æŠ€è¡“æ£§
3. **ä¿®æ”¹ Prisma Schema** â†’ æé†’æª¢æŸ¥ `.claude/rules/database.md`
4. **å»ºç«‹æ–°çš„ API ç«¯é»** â†’ æé†’æª¢æŸ¥ API è·¯ç”±çµæ§‹æ–‡æª”
5. **é‡åˆ°ä¸¦è§£æ±ºè¤‡é›œå•é¡Œ** â†’ æé†’è¨˜éŒ„åˆ° `.claude/rules/` ä½œç‚ºç¶“é©—

### ç¯„ä¾‹ï¼šé–‹ç™¼å®Œæˆå¾Œçš„æ–‡æª”æ›´æ–°

```bash
# æƒ…å¢ƒï¼šå®Œæˆ Story 3.2 - æ–°å¢æ˜ å°„æœå‹™

## éœ€è¦æ›´æ–°çš„æ–‡æª”ï¼š

1. src/services/index.ts
   - æ–°å¢ export * from './mapping-service'
   - æ›´æ–° @features åˆ—è¡¨

2. CLAUDE.md
   - æ›´æ–°é …ç›®é€²åº¦ï¼šEpic 3 ç‹€æ…‹æ”¹ç‚º ğŸŸ¡ é€²è¡Œä¸­

3. .claude/rules/services.mdï¼ˆå¦‚ç™¼ç¾æ–°æ¨¡å¼ï¼‰
   - è¨˜éŒ„æ˜ å°„æœå‹™çš„è¨­è¨ˆæ¨¡å¼
   - è¨˜éŒ„ä¸‰å±¤æ˜ å°„çš„å¯¦ç¾è¦é»
```

---

## é …ç›®é€²åº¦è¿½è¹¤

> **é€²åº¦ä¾†æº**: `docs/04-implementation/sprint-status.yaml` - é …ç›®é€²åº¦çš„å”¯ä¸€çœŸå¯¦ä¾†æº

### Epic çµæ§‹ï¼ˆ16 å€‹ Epicï¼Œ104 å€‹ Storiesï¼‰

| Epic | åç¨±                        | Stories | ç‹€æ…‹      | å®Œæˆæ—¥æœŸ   |
| ---- | --------------------------- | ------- | --------- | ---------- |
| 0    | æ­·å²æ•¸æ“šåˆå§‹åŒ–ï¼ˆå‰ç½® Epicï¼‰ | 7       | âœ… å·²å®Œæˆ | 2025-12-26 |
| 1    | ç”¨æˆ¶èªè­‰èˆ‡å­˜å–æ§åˆ¶          | 9       | âœ… å·²å®Œæˆ | 2025-12-18 |
| 2    | æ‰‹å‹•ç™¼ç¥¨ä¸Šå‚³èˆ‡ AI è™•ç†      | 7       | âœ… å·²å®Œæˆ | 2025-12-18 |
| 3    | ç™¼ç¥¨å¯©æ ¸èˆ‡ä¿®æ­£å·¥ä½œæµ        | 8       | âœ… å·²å®Œæˆ | 2025-12-19 |
| 4    | æ˜ å°„è¦å‰‡ç®¡ç†èˆ‡è‡ªå‹•å­¸ç¿’      | 8       | âœ… å·²å®Œæˆ | 2025-12-19 |
| 5    | Forwarder é…ç½®ç®¡ç†          | 5       | âœ… å·²å®Œæˆ | 2025-12-19 |
| 6    | å¤šåŸå¸‚æ•¸æ“šéš”é›¢              | 5       | âœ… å·²å®Œæˆ | 2025-12-19 |
| 7    | å ±è¡¨å„€è¡¨æ¿èˆ‡æˆæœ¬è¿½è¹¤        | 10      | âœ… å·²å®Œæˆ | 2025-12-20 |
| 8    | å¯©è¨ˆè¿½æº¯èˆ‡åˆè¦              | 6       | âœ… å·²å®Œæˆ | 2025-12-20 |
| 9    | è‡ªå‹•åŒ–æ–‡ä»¶ç²å–              | 5       | âœ… å·²å®Œæˆ | 2025-12-20 |
| 10   | n8n å·¥ä½œæµæ•´åˆ              | 7       | âœ… å·²å®Œæˆ | 2025-12-21 |
| 11   | å°å¤– API æœå‹™               | 6       | âœ… å·²å®Œæˆ | 2025-12-21 |
| 12   | ç³»çµ±ç®¡ç†èˆ‡ç›£æ§              | 7       | âœ… å·²å®Œæˆ | 2025-12-21 |
| 13   | æ–‡ä»¶é è¦½èˆ‡æ¬„ä½æ˜ å°„          | 5       | â¸ï¸ è¦åŠƒä¸­ | -          |
| 14   | Prompt é…ç½®èˆ‡å‹•æ…‹ç”Ÿæˆ       | 4       | â¸ï¸ è¦åŠƒä¸­ | -          |
| 15   | çµ±ä¸€ 3 å±¤æ©Ÿåˆ¶åˆ°æ—¥å¸¸è™•ç†æµç¨‹ | 5       | â¸ï¸ è¦åŠƒä¸­ | -          |

### é‡è¦é‡æ§‹è¨˜éŒ„

| é‡æ§‹         | èªªæ˜                         | ç‹€æ…‹      | å®Œæˆ Story |
| ------------ | ---------------------------- | --------- | ---------- |
| REFACTOR-001 | Forwarder â†’ Company æ¨¡å‹é‡æ§‹ | âœ… å·²å®Œæˆ | Story 0-3  |

---

## èªè¨€è¨­å®š

- **ç”¨æˆ¶æºé€šèªè¨€**: ç¹é«”ä¸­æ–‡
- **ä»£ç¢¼è¨»é‡‹**: ä¸­æ–‡æˆ–è‹±æ–‡ï¼ˆä¾æ“šä¸Šä¸‹æ–‡ï¼‰
- **Commit Message**: è‹±æ–‡
- **æ–‡æª”**: ç¹é«”ä¸­æ–‡ç‚ºä¸»

---

## ç‰ˆæœ¬è³‡è¨Š

- **CLAUDE.md ç‰ˆæœ¬**: 2.1.0
- **å»ºç«‹æ—¥æœŸ**: 2025-12-17
- **æœ€å¾Œæ›´æ–°**: 2026-01-02
- **ç¶­è­·è€…**: Development Team

### æ›´æ–°è¨˜éŒ„

| ç‰ˆæœ¬  | æ—¥æœŸ       | è®Šæ›´å…§å®¹                                                                         |
| ----- | ---------- | -------------------------------------------------------------------------------- |
| 2.1.0 | 2026-01-02 | æ–°å¢ Epic 13-15 è¦åŠƒæ–‡æª”ã€æ›´æ–° Epic ç¸½æ•¸è‡³ 16 å€‹ã€Story ç¸½æ•¸è‡³ 104 å€‹            |
| 2.0.0 | 2025-12-26 | é‡å¤§æ›´æ–°ï¼šå…¨éƒ¨ 13 å€‹ Epic å·²å®Œæˆã€æ–°å¢ Epic 0ã€æ›´æ–°ç›®éŒ„çµæ§‹ã€Story æ•¸é‡æ›´æ­£ç‚º 90 |
| 1.4.0 | 2025-12-18 | Story 2-2 å®Œæˆï¼šOCR æå–æœå‹™ï¼ˆPython FastAPI + Next.js APIï¼‰                     |
| 1.3.0 | 2025-12-18 | Story 2-1 å®Œæˆï¼ŒEpic 2 é–‹å§‹é€²è¡Œ                                                  |
| 1.2.0 | 2025-12-18 | Epic 1 å®Œæˆï¼Œæ›´æ–°é …ç›®é€²åº¦å’Œ Epic åç¨±ï¼ˆä¸­æ–‡åŒ–ï¼‰                                  |
| 1.1.0 | 2025-12-18 | æ–°å¢ã€Œé–‹ç™¼å¾Œæ–‡æª”æ›´æ–°æª¢æŸ¥ã€ç« ç¯€                                                   |
| 1.0.0 | 2025-12-17 | åˆå§‹ç‰ˆæœ¬                                                                         |
